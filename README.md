# Router Vulnerability Scan Tool
Tool able to check the security level of a router. Check if the router is vulnerable to DNS rebinding and if there are any known CVEs or exploits.

`Singularity of Origin` is a tool to perform [DNS rebinding](https://en.wikipedia.org/wiki/DNS_rebinding) attacks.
It includes the necessary components to rebind the IP address of the attack server DNS name to the target machine's IP address and to serve attack payloads to exploit vulnerable software on the target machine. 

Detailed documentation is on the [wiki pages](https://github.com/nccgroup/singularity/wiki).

## Setup and Installation

### Requirements

* Go version 1.16 or newer.
* A Linux server with public IP address; the server can be obtained from a hosting providers, such as [Linode](https://www.linode.com/), [Amazon AWS](https://aws.amazon.com/ec2/), etc.
* A Domain you can buy it from [namecheap](https://www.namecheap.com/), [gandi](https://www.gandi.net), etc. You need be able to add and edit your own DNS records for your domain.


### Setup

#### DNS configuration

From the DNS management web interface of the domain registrar from which the domain was purchased, the following DNS records must be added:

* **Type**: "A" **Name**: "rebinder", **IPv4**: "*youripaddress*". 
  This record allows you to access the application also by typing "rebinder.yourdomain".
* **Type**: "NS" **Name**: "dynamic", **IPv4**: "*rebinder.yourdomain*".
  This record allows you to access the application through any subdomain of the type ".dynamic.yourdomain.", for example "foo.dynamic.yourdomain".
* **Type**: "A" **Name**: "*", **IPv4**: "*youripaddress*". 
  This record is required in order to use the browser as a proxy. 

#### Server configuration
The server requires the Go programming language in order to compile and run the application.

##### Install Golang
Follow the instructions from the official [Go Programming Language web site](https://golang.org/doc/install).

##### Obtain Singularity

To download the application you need to clone the repository with the following command:

```bash
$ git clone https://github.com/peace27-96/Router-Vulnerability-Scan-Tool.git
````

##### Compile 

To compile the application, you need to run the following commands:

```bash
$ cd singularity/cmd/singularity-server
$ go build
````

##### Deploy

To deploy the application, run the following commands from the directory `singularity/cmd/singularity-server`.

```bash
$ mkdir -p ~/singularity/html
$ cp singularity-server ~/singularity/
$ cp -r ../../html/* ~/singularity/html/
```

##### Run
Run the following commands:

```bash
$ cd ~/singularity/
$ sudo ./singularity-server --HTTPServerPort 80
```

The application uses UDP port 53, therefore it is necessary to "kill" the server processes listening on this port.
On Ubuntu 18.04 LTS, by default, `systemd-resolved` is listening on UDP port 53. To be able to "kill" this process, run the following command:
```bash
$ sudo systemctl disable --now systemd-resolved.service
```

Then edit the `/etc/resolv.conf` file, delete `127.0.0.53` and replace it with the IP address of a DNS server, for example `8.8.8.8` the IP address of the Google DNS server.

### Testing

To verify that the setup and installation of the application have been successful, it is advisable to run a test, not directly to your router, but on a specially created web server running on your machine.
* Run the application;
* Creation of the web server on your machine: to create and start the web server execute the following command: `$ python -c 'import BaseHTTPServer as bhs, Sim-pleHTTPServer as shs; bhs.HTTPServer(("127.0.0.1",80), shs.SimpleHTTPRequestHandler).serve_forever()'` from a directory on your machine that contains some files;
* Connect with the browser to the application;
* Enter "dynamic.yourdomain" in the attack host domain;
* Enter "youripaddress" in the attack host domain;
* Enter "127.0.0.1" in the attack host domain;
* Run the test;
* The contents of the web server directory should appear in the application console.

